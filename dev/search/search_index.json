{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"DFT/DFT/","title":"About K-points","text":"<p>When you solve the Schr\u00f6dinger equation for a periodic system like a crystal, the solution can be broken into two parts: one that describes how the wavefunction behaves within each unit cell, and another that describes how it changes across unit cells. The k-points tell you how the wavefunction shifts as you move from one cell to the next. At the Gamma point (k = 0), there\u2019s no change, the wavefunction looks identical in every cell. As you move to small k, the wavefunction shifts gradually across the crystal, which allows you to describe a more complex wavefunction than one in which the same thing just repeats in each unit cell. At the edges of the Brillouin zone, the wavefunction can \u201cflip\u201d from one unit cell to the next, like alternating sign. So, when describing all the solutions to the Schr\u00f6dinger equation, k-points basically allow you to separate it into parts that can be more intuitive to interpret(and calculate). </p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/","title":"Installation CASTEP - AOCL","text":""},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#castep-2512-aocl-ubuntu-2404-ryzen-3900x-guia-final","title":"CASTEP 25.12 + AOCL (Ubuntu 24.04, Ryzen 3900X) \u2014 Guia Final","text":""},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#0-pre-requisitos","title":"0) Pr\u00e9-requisitos","text":"<p><pre><code>sudo apt update\nsudo apt install -y build-essential gfortran cmake git \\\n    libopenmpi-dev openmpi-bin \\\n    libfftw3-dev python3 python3-pip gawk\n</code></pre> Confirme MPI <pre><code>which mpif90\nwhich mpirun\n# Esperado:\n# /usr/bin/mpif90\n# /usr/bin/mpirun\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#1-definir-aocl-e-diretorios-de-biblioteca","title":"1) Definir AOCL e diret\u00f3rios de biblioteca","text":"<p>Voc\u00ea instalou o AOCL em: /opt/AMD/aocl/aocl-linux-gcc-5.1.0</p> <p>Defina vari\u00e1veis e caminho das libs (LP64):</p> <pre><code>export AOCL=/opt/AMD/aocl/aocl-linux-gcc-5.1.0\nexport LIBDIR=$AOCL/gcc/lib_LP64\nexport LD_LIBRARY_PATH=$LIBDIR:$LD_LIBRARY_PATH\n</code></pre>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#2-ajustar-symlinks-das-libs-aocl-uma-vez-so","title":"2) Ajustar symlinks das libs AOCL (uma vez s\u00f3)","text":"<p>O CASTEP procura libblis.so e libflame.so. No AOCL encontramos:</p> <p><pre><code>/opt/AMD/aocl/aocl-linux-gcc-5.1.0/gcc/lib_LP64/libblis.so.5.1.0\n/opt/AMD/aocl/aocl-linux-gcc-5.1.0/gcc/lib_LP64/libflame.so\n</code></pre> Crie os symlinks (no mesmo diret\u00f3rio): <pre><code>cd /opt/AMD/aocl/aocl-linux-gcc-5.1.0/gcc/lib_LP64\nsudo ln -s libblis.so.5.1.0 libblis.so\nsudo ln -s libblis-mt.so.5.1.0 libblis-mt.so\n# libflame.so j\u00e1 tem o nome esperado\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#3-descompactar-o-castep","title":"3) Descompactar o CASTEP","text":"<pre><code>tar -zxf CASTEP-25.12.tar.gz\ncd CASTEP-25.12\n</code></pre>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#4-compilar-serial-e-mpi-com-aocl-fftw3","title":"4) Compilar (serial e MPI) com AOCL + FFTW3","text":"<p>4.1 Serial (opcional, \u00fatil para utilit\u00e1rios)</p> <p><pre><code>make clean\nmake -j$(nproc) COMMS_ARCH=serial \\\n     MATHLIBS=aocl MATHLIBDIR=\"$LIBDIR\" \\\n     FFT=fftw3  FFTLIBDIR=\"$LIBDIR\" \\\n     BUILD=fast TARGETCPU=host\nmake COMMS_ARCH=serial install\n</code></pre> Instala em: <pre><code>bin/linux_x86_64_gfortran10--serial/\n</code></pre> 4.2 MPI (principal) <pre><code>make clean\nmake -j$(nproc) COMMS_ARCH=mpi \\\n     MATHLIBS=aocl MATHLIBDIR=\"$LIBDIR\" \\\n     FFT=fftw3  FFTLIBDIR=\"$LIBDIR\" \\\n     BUILD=fast TARGETCPU=host\nmake COMMS_ARCH=mpi install\n</code></pre></p> <p>Instala em: <pre><code>bin/linux_x86_64_gfortran10--mpi/\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#5-verificar-linkedicao-com-aocl","title":"5) Verificar linkedi\u00e7\u00e3o com AOCL","text":"<pre><code>ldd obj/linux_x86_64_gfortran*/castep.mpi | grep -E \"blis|flame\"\n# Esperado (caminhos AOCL):\n# libflame.so =&gt; /opt/AMD/aocl/aocl-linux-gcc-5.1.0/gcc/lib_LP64/libflame.so\n# libblis.so.5 =&gt; /opt/AMD/aocl/aocl-linux-gcc-5.1.0/gcc/lib_LP64/libblis.so.5\n# libblis-mt.so.5 =&gt; /opt/AMD/aocl/aocl-linux-gcc-5.1.0/gcc/lib_LP64/libblis-mt.so.5\n</code></pre>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#6-teste-rapido-mpi","title":"6) Teste r\u00e1pido (MPI)","text":"<p>Com arquivos si.cell/si.param prontos, rode: <pre><code>mpirun -np 4 ~/CASTEP/CASTEP-25.12/bin/linux_x86_64_gfortran10--mpi/castep.mpi si\n</code></pre></p> <p>(Ajuste -np conforme desejar.)</p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#7-persistir-ambiente-no-bashrc","title":"7) Persistir ambiente no ~/.bashrc","text":"<p>Abra o arquivo:</p> <p><pre><code>nano ~/.bashrc\n</code></pre> Adicione ao final (usando os mesmos nomes de vari\u00e1veis/comandos que usamos acima): <pre><code># === AOCL libraries ===\nexport AOCL=/opt/AMD/aocl/aocl-linux-gcc-5.1.0\nexport LD_LIBRARY_PATH=$AOCL/gcc/lib_LP64:$LD_LIBRARY_PATH\n\n# === CASTEP binaries (MPI) ===\nexport PATH=$HOME/CASTEP/CASTEP-25.12/bin/linux_x86_64_gfortran10--mpi:$PATH\n</code></pre> Salve e recarregue: <pre><code>source ~/.bashrc\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#8-wrapper-para-simplificar-mpirun-np-castepmpi","title":"8) Wrapper para simplificar mpirun -np ... castep.mpi","text":"<p>Crie /usr/local/bin/castep-mpi:</p> <pre><code>sudo bash -lc 'cat &gt; /usr/local/bin/castep-mpi &lt;&lt; \"EOF\"\n#!/bin/bash\n# Uso: castep-mpi &lt;nprocs&gt; &lt;seed&gt; [args...]\nNPROCS=\"$1\"\nSEED=\"$2\"\nshift 2\nmpirun -np \"$NPROCS\" $HOME/CASTEP/CASTEP-25.12/bin/linux_x86_64_gfortran10--mpi/castep.mpi \"$SEED\" \"$@\"\nEOF\nchmod +x /usr/local/bin/castep-mpi'\n</code></pre> <p>Agora voc\u00ea pode rodar assim: <pre><code>castep-mpi 4 si\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#9-duvidas-comuns-troubleshooting","title":"9) D\u00favidas comuns / Troubleshooting","text":"<p>MPI_ABORT ... errorcode 1 logo no in\u00edcio Quase sempre \u00e9 falta de pseudopotencial. Use OTFG no .cell: <pre><code>%BLOCK SPECIES_POT\nSi  OTFG  [Si] 3|2.0|2.0|2.0:2|6.0|8.0|10.0\n%ENDBLOCK SPECIES_POT\n</code></pre> ou defina PSPOT_DIR para .usp.</p> <p>cannot find -lflame / -lblis Garanta:</p> <pre><code>export LIBDIR=$AOCL/gcc/lib_LP64\n\nexport LD_LIBRARY_PATH=$LIBDIR:$LD_LIBRARY_PATH\n</code></pre> <p>symlinks criados (passo 2).</p> <p>Utilit\u00e1rios reclamando diret\u00f3rio --serial ausente no make install \u00c9 normal se voc\u00ea instalou s\u00f3 MPI. Para instalar utilit\u00e1rios, tamb\u00e9m rode o build/instala\u00e7\u00e3o serial:</p> <p><pre><code>make COMMS_ARCH=serial BUILD=fast TARGETCPU=host\nmake COMMS_ARCH=serial install\n</code></pre> Quantos processos usar? Sua CPU tem 12 cores f\u00edsicos / 24 threads. Comece testando:</p> <p>castep-mpi 12 si (1 MPI por core f\u00edsico)</p> <p>compare com castep-mpi 24 si (1 MPI por thread)</p> <p>e com castep-mpi 4 si (teste leve)</p>"},{"location":"DFT/Installation%20CASTEP%20-%20AOCL/#10-exemplo-final-de-execucao","title":"10) Exemplo final de execu\u00e7\u00e3o","text":"<pre><code># com wrapper e 12 processos (recomenda\u00e7\u00e3o inicial)\ncastep-mpi 12 si\n</code></pre>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/","title":"Installation CASTEP - MKL","text":""},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#castep-2512-intel-mkl-openmpi-on-ubuntu-2404","title":"CASTEP 25.12 + Intel MKL + OpenMPI on Ubuntu 24.04","text":"<p>This guide explains how to install and run CASTEP 25.12 with Intel MKL and OpenMPI on Ubuntu 24.04.</p>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#system-information","title":"System Information","text":"<ul> <li>CPU: <code>Intel Core i9</code> (24 cores / 32 threads)</li> <li>RAM: <code>128 GB</code></li> <li>OS: <code>Ubuntu 24.04 LTS</code></li> <li>Compilers: <code>GNU Fortran 13.x</code></li> <li>MPI: <code>OpenMPI 4.1.x</code></li> <li>Math library: <code>Intel MKL</code> (installed via <code>apt</code>)</li> </ul>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#prerequisites","title":"Prerequisites","text":"<p>Install required packages:</p> <pre><code>sudo apt update\nsudo apt install -y build-essential gfortran cmake git \\\n    libopenmpi-dev openmpi-bin \\\n    libfftw3-dev python3 python3-pip gawk intel-mkl\n</code></pre>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#locating-mkl-libraries","title":"Locating MKL Libraries","text":"<p>MKL libraries are installed in <code>/lib/x86_64-linux-gnu/</code> and headers in <code>/usr/include/mkl</code>.</p> <p>Check: <pre><code>ldconfig -p | grep mkl\nls /usr/include/mkl\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#environment-setup","title":"Environment Setup","text":"<p>Add to your <code>~/.bashrc</code>: <pre><code># === Intel MKL ===\nexport MKL_LIB=/lib/x86_64-linux-gnu\nexport MKL_INC=/usr/include/mkl\nexport INCLUDE=$MKL_INC\nexport LD_LIBRARY_PATH=$MKL_LIB:$LD_LIBRARY_PATH\n\n# Avoid MPI + MKL thread oversubscription\nexport MKL_INTERFACE_LAYER=LP64\nexport MKL_THREADING_LAYER=GNU\nexport OMP_NUM_THREADS=1\n\n# === CASTEP binaries ===\nexport PATH=$HOME/CASTEP/CASTEP-25.12/bin/linux_x86_64_gfortran10--mpi:$PATH\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#building-castep","title":"Building CASTEP","text":"<p>Unpack the source: <pre><code>tar -zxf CASTEP-25.12.tar.gz\ncd CASTEP-25.12\n</code></pre> Clean previous build </p> <pre><code>rm -rf obj/linux_x86_64_gfortran10--mpi\n</code></pre>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#mpi-build-with-mkl","title":"MPI build with MKL","text":"<p>First run make</p> <p>DL_MG=None</p> <p>In this setup, we were not able install dl_mg module. We have tried several times and the following error kept being thrown out during make statement.Error: <pre><code>/usr/bin/ld: /home/numsim/CASTEP/CASTEP-25.12/obj/linux_x86_64_gfortran10--mpi/build/../../../Source/Functional/multigrid_dlmg.f90:444:(.text+0x146db): undefined reference to __dl_mg_MOD_dl_mg_error_string' collect2: error: ld returned 1 exit status make[1]: *** [Makefile:220: ../castep.mpi] Error 1 rm f90wrap_stub.anc make[1]: Leaving directory '/home/numsim/CASTEP/CASTEP-25.12/obj/linux_x86_64_gfortran10--mpi/build' make: *** [make.inc:236: castep] Error 2\n</code></pre></p> <p>As a solution we have chosen the following command: <pre><code>make -j$(nproc) COMMS_ARCH=mpi DL_MG=none \\\n  MATHLIBS=mkl MATHLIBDIR=\"$MKL_LIB\" \\\n  FFT=mkl FFTLIBDIR=\"$MKL_LIB\" \\\n  EXTRA_LIBS=\"-Wl,--start-group -lmkl_intel_lp64 -lmkl_gnu_thread -lmkl_core -Wl,--end-group -lsymspg -lgomp -lpthread -lm -ldl\" \\\n  LDFLAGS=\"-L$MKL_LIB -Wl,--no-as-needed -Wl,-rpath,$MKL_LIB\" \\\n  BUILD=fast TARGETCPU=host\n</code></pre> then install: <pre><code>make COMMS_ARCH=mpi install\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#verifying-installation","title":"Verifying installation","text":"<p>Check that the binary links against MKL and spglib: <pre><code>ldd bin/linux_x86_64_gfortran10--mpi/castep.mpi | grep -E \"mkl|symspg\"\n</code></pre> Run version header check: <pre><code>mpirun -np 4 bin/linux_x86_64_gfortran10--mpi/castep.mpi --version\n</code></pre> Expected: MKL and OpenMPI are listed.</p>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#wrapper-script","title":"Wrapper Script","text":"<p>To run only commadn castep-mpi as default <pre><code>sudo bash -lc 'cat &gt; /usr/local/bin/castep-mpi &lt;&lt; \"EOF\"\n#!/bin/bash\n# Usage: castep-mpi &lt;nprocs&gt; &lt;seed&gt; [args...]\nNPROCS=\"$1\"; SEED=\"$2\"; shift 2\nmpirun -np \"$NPROCS\" --bind-to core \"$HOME/CASTEP/CASTEP-25.12/bin/linux_x86_64_gfortran10--mpi/castep.mpi\" \"$SEED\" \"$@\"\nEOF\nchmod +x /usr/local/bin/castep-mpi'\n</code></pre> Now you run jobs with: <pre><code>castep-mpi 24 si\n</code></pre></p>"},{"location":"DFT/Installation%20CASTEP%20-%20MKL/#troubleshoting","title":"Troubleshoting","text":"<p>MPI_ABORT error at start: missing pseudopotential \u2192 check SPECIES_POT block or PSPOT_DIR.</p> <p>Falls back to generic BLAS (-llapack -lblas): ensure MKL paths are set and passed to make.</p> <p>Undefined DL_MG symbols: either disable (DL_MG=none) or build DL_MG (DL_MG=compile) if available in your source</p>"},{"location":"DFT/Python%20Runner/","title":"CASTEP Runner","text":"<p>You find our python package to run automated scans in castep using the wraper castep-mpi on ubuntu plataforms. here</p>"},{"location":"DFT/Python%20Runner/#castep-runner-user-guide","title":"CASTEP Runner \u2014 User Guide","text":""},{"location":"DFT/Python%20Runner/#introduction","title":"Introduction","text":"<p><code>CASTEP Runner</code> is a modular Python wrapper that automates launching <code>castep-mpi</code> calculations. It helps organize runs in dedicated folders, automatically edits CASTEP input files, and supports parameter scans.</p> <p>Highlights:</p> <ul> <li>Edits <code>cut_off_energy</code> in <code>.param</code> files.</li> <li>Edits <code>kpoint_mp_grid</code> in <code>.cell</code> files.</li> <li>Stages all relevant input files into a clean run directory.</li> <li>Executes <code>castep-mpi &lt;np&gt; &lt;seedname&gt;</code> inside that directory.</li> <li>Supports single runs and scans (cutoff or k-grid).</li> <li>Provides <code>--dry-run</code> mode for setup without execution.</li> </ul>"},{"location":"DFT/Python%20Runner/#installation","title":"Installation","text":"<p>Requirements:</p> <ul> <li>Python 3.8+</li> <li><code>castep-mpi</code> in your <code>$PATH</code></li> </ul> <p>Clone or copy the package structure:</p> <pre><code>project/\n\u251c\u2500 run_castep.py\n\u2514\u2500 castep_runner/\n   \u251c\u2500 __init__.py\n   \u251c\u2500 cli.py\n   \u251c\u2500 io_utils.py\n   \u251c\u2500 param_edit.py\n   \u251c\u2500 cell_edit.py\n   \u251c\u2500 runner.py\n   \u2514\u2500 constants.py\n</code></pre> <p>Make the entry point executable:</p> <pre><code>chmod +x run_castep.py\n</code></pre>"},{"location":"DFT/Python%20Runner/#usage","title":"Usage","text":""},{"location":"DFT/Python%20Runner/#single-cutoff-run","title":"Single cutoff run","text":"<pre><code>python run_castep.py &lt;NP&gt; &lt;SEEDNAME&gt; --cutoff &lt;INT&gt;\n</code></pre> <ul> <li>Creates <code>cutoffs/&lt;seedname&gt;_&lt;cutoff&gt;/</code></li> <li>Stages inputs</li> <li>Ensures <code>cut_off_energy : &lt;cutoff&gt; eV</code> in <code>.param</code></li> <li>Runs CAStep</li> </ul>"},{"location":"DFT/Python%20Runner/#cutoff-scan","title":"Cutoff scan","text":"<pre><code>python run_castep.py &lt;NP&gt; &lt;SEEDNAME&gt; --cutoff-scan START END STEP\n</code></pre> <ul> <li>Generates subdirectories for each cutoff value.</li> <li>Inclusion rule: always include <code>START</code>; include <code>END</code> only if reached exactly by stepping.</li> </ul>"},{"location":"DFT/Python%20Runner/#single-k-point-grid","title":"Single k-point grid","text":"<pre><code>python run_castep.py &lt;NP&gt; &lt;SEEDNAME&gt; --kgrid NX NY NZ\n</code></pre> <ul> <li>Creates <code>kgrids/&lt;seedname&gt;_&lt;NX&gt;x&lt;NY&gt;x&lt;NZ&gt;/</code></li> <li>Edits <code>.cell</code> with <code>kpoint_mp_grid NX NY NZ</code></li> <li>Runs CAStep</li> </ul>"},{"location":"DFT/Python%20Runner/#k-grid-scan","title":"K-grid scan","text":"<pre><code>python run_castep.py &lt;NP&gt; &lt;SEEDNAME&gt; --kgrid-scan S1 E1 T1  S2 E2 T2  S3 E3 T3\n</code></pre> <ul> <li>First triple <code>(S1,E1,T1)</code>: starting grid.</li> <li>Second triple <code>(S2,E2,T2)</code>: ending grid.</li> <li>Third triple <code>(S3,E3,T3)</code>: step increments.</li> <li>All three axes advance together. Non-varying axes should have step <code>0</code>.</li> </ul> <p>Examples:</p> <ul> <li>Vary only Nx:</li> </ul> <p><pre><code>python run_castep.py 4 SiO2 --kgrid-scan 2 2 2  6 2 2  2 0 0\n# \u2192 (2 2 2), (4 2 2), (6 2 2)\n</code></pre> * Vary all axes equally:</p> <pre><code>python run_castep.py 4 SiO2 --kgrid-scan 2 2 2  8 8 8  2 2 2\n# \u2192 (2 2 2), (4 4 4), (6 6 6), (8 8 8)\n</code></pre> <p>Inclusion rule: start is always included; end is included only if exactly reached.</p>"},{"location":"DFT/Python%20Runner/#dry-run","title":"Dry run","text":"<pre><code>python run_castep.py 4 SiO2 --cutoff 700 --dry-run\n</code></pre> <p>Prepares the directory and edits inputs but does not execute CAStep.</p>"},{"location":"DFT/Python%20Runner/#input-staging","title":"Input Staging","text":"<ul> <li>Copies <code>.cell</code>, <code>.param</code>, <code>.usp</code>, and other relevant files.</li> <li>Copies any <code>seedname.*</code> file as a catch-all.</li> <li>Existing files in run directories are not overwritten.</li> </ul>"},{"location":"DFT/Python%20Runner/#editing-behavior","title":"Editing Behavior","text":"<ul> <li>.param: ensures a line <code>cut_off_energy : &lt;value&gt; eV</code> exists and updates it.</li> <li>.cell: ensures a line <code>kpoint_mp_grid &lt;nx&gt; &lt;ny&gt; &lt;nz&gt;</code> exists and updates it.</li> </ul>"},{"location":"DFT/Python%20Runner/#output-organization","title":"Output Organization","text":"<ul> <li>Cutoff runs: <code>cutoffs/&lt;seedname&gt;_&lt;cutoff&gt;/</code></li> <li>K-grid runs: <code>kgrids/&lt;seedname&gt;_&lt;nx&gt;x&lt;ny&gt;x&lt;nz&gt;/</code></li> </ul> <p>Each folder contains both inputs and outputs, ensuring reproducibility.</p>"},{"location":"DFT/Python%20Runner/#exit-codes","title":"Exit Codes","text":"<ul> <li><code>0</code> \u2014 success</li> <li><code>127</code> \u2014 <code>castep-mpi</code> not found</li> <li><code>1</code> \u2014 missing required input file (<code>.param</code> or <code>.cell</code>)</li> <li><code>2</code> \u2014 invalid scan arguments</li> <li>Non-zero from CAStep \u2014 propagated upwards</li> </ul>"},{"location":"DFT/Python%20Runner/#extending","title":"Extending","text":"<ul> <li>Parallel scans: add <code>--jobs N</code> and use multiprocessing.</li> <li>Additional parameters: implement in <code>param_edit.py</code> or <code>cell_edit.py</code>.</li> <li>Scheduler integration: replace direct run with SLURM/LSF submission.</li> </ul>"},{"location":"DFT/Python%20Runner/#programmatic-api","title":"Programmatic API","text":"<pre><code>from castep_runner.io_utils import ensure_run_dir, stage_inputs\nfrom castep_runner.param_edit import set_cutoff_in_param\nfrom castep_runner.cell_edit import set_kgrid_in_cell\nfrom castep_runner.runner import run_castep\n\nrun_dir = ensure_run_dir(\"SiO2\", 700)\nstage_inputs(\"SiO2\", run_dir)\nset_cutoff_in_param(run_dir/\"SiO2.param\", 700)\nset_kgrid_in_cell(run_dir/\"SiO2.cell\", 4, 4, 4)\nrc = run_castep(4, \"SiO2\", run_dir)\n</code></pre>"},{"location":"DFT/Python%20Runner/#maintainer-notes","title":"Maintainer Notes","text":"<ul> <li>Keep CLI logic in <code>cli.py</code>.</li> <li>Keep editing isolated in <code>param_edit.py</code> and <code>cell_edit.py</code>.</li> <li>Add tests around scan behavior (cutoff and k-grid) to ensure reproducibility.</li> </ul>"},{"location":"SIMPSON/Installation/","title":"Installation","text":""},{"location":"SIMPSON/Installation/#overview","title":"Overview","text":"<p>This document describes how to install SIMPSON 4.2.1 on Ubuntu, and how to fix a common Tcl version mismatch error.</p> <p>The process was tested successfully on:</p> <ul> <li> <p>Ubuntu 24.04 + AMD processor (with optimized BLAS/LAPACK/FFTW for AMD)</p> </li> <li> <p>Ubuntu 24.04 + Intel i9 processor (with optimized BLAS/LAPACK/FFTW for Intel)</p> </li> </ul> <p>Both setups also included MPI (mpirun) for parallel execution.</p>"},{"location":"SIMPSON/Installation/#1-installation","title":"1. Installation","text":"<p>After downloading SIMPSON 4.2.1, run the installer script: <pre><code>sudo ./install.sh\n</code></pre> This installs the simpson wrapper into /usr/local/bin and the libraries into /usr/share/simpson</p> <p>If you try <pre><code>simpson test.in\n</code></pre> you going to face the following error: <pre><code>SIMPSON is unable to initialize Tcl interpreter. Is init.tcl on your path? Error: Can't find a usable init.tcl in the following directories: /usr/share/simpson/tcl8.6 /usr/share/tcltk/tcl8.6 ./lib/tcl8.6 ./lib/tcl8.6 ./library ./library ./tcl8.6.5/library ./tcl8.6.5/library /usr/share/tcltk/tcl8.6/init.tcl: version conflict for package \"Tcl\": have 8.6.5, need exactly 8.6.14 version conflict for package \"Tcl\": have 8.6.5, need exactly 8.6.14 while executing \"package require -exact Tcl 8.6.14\" (file \"/usr/share/tcltk/tcl8.6/init.tcl\" line 19) invoked from within \"source /usr/share/tcltk/tcl8.6/init.tcl\" (\"uplevel\" body line 1) invoked from within \"uplevel #0 [list source $tclfile]\"\n</code></pre> The cause is SIMPSON installer ships with an outdated Tcl 8.6.5 but the SIMPSON 4.2.1 binary is built against Tcl 8.6.14. This mismath prevents startups.</p>"},{"location":"SIMPSON/Installation/#fixing-the-tcl-issue","title":"Fixing the tcl issue","text":"<p>Instead of using the bundled Tcl, we point SIMPSON to Ubuntu\u2019s system Tcl (already at 8.6.14). Edit the following wrapper script: <pre><code>sudo nano /usr/local/bin/simpson\n</code></pre> Change only these two lines: <pre><code>export TCL_LIBRARY=/usr/share/simpson/tcl8.6\nexport LD_LIBRARY_PATH=/usr/share/simpson\n</code></pre> to  <pre><code>export TCL_LIBRARY=/usr/share/tcltk/tcl8.6\nexport LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu\n</code></pre> save and exit.</p>"},{"location":"SIMPSON/Installation/#verification","title":"Verification","text":"<p>Run now the same command: <pre><code>simpson test.in\n</code></pre></p>"},{"location":"SIMPSON/Installation/#parallel-execution","title":"Parallel execution","text":"<p>If you have installed the packages for parallel execution (you can refer the DFT documentation in this website to install them). You can run <pre><code>mpirun -np 8 simpson test.in\n</code></pre> The flag <code>np</code> is used to account for the number of total processor. If you have a 4 machines with 2 cores, then your np should be 4x2, which is 8 in the example above.</p>"},{"location":"SIMPSON/Installation/#notes-on-hardware","title":"Notes on Hardware","text":"<ul> <li> <p>On AMD-based Ubuntu, SIMPSON runs correctly with AMD-optimized math libraries (BLAS/LAPACK/FFTW).</p> </li> <li> <p>On Intel i9-based Ubuntu, SIMPSON also runs correctly with Intel-optimized libraries.</p> </li> </ul> <p>Both environments had MPI (mpirun) installed for distributed simulations, and no MPI-related issues occurred.</p>"},{"location":"SIMPSON/SIMPSON/","title":"SIMPSON Overview","text":""},{"location":"SIMPSON/SIMPSON/#what-is-simpson","title":"What is SIMPSON?","text":"<p>SIMPSON (Simulation Program for Solid-State NMR) is a powerful open-source program for simulating nuclear magnetic resonance (NMR) experiments, especially in the solid state.</p> <p>It was originally developed by Thomas Vosegaard and collaborators, and is widely used in research groups worldwide for designing, analyzing, and understanding complex NMR experiments.</p> <p>At its core, SIMPSON allows users to:</p> <ul> <li> <p>Define spin systems and Hamiltonians</p> </li> <li> <p>Simulate pulse sequences (1D, 2D, MAS, multi-pulse)</p> </li> <li> <p>Include powder averaging and relaxation models</p> </li> <li> <p>Compare simulated spectra with experimental results</p> </li> </ul>"},{"location":"SIMPSON/SIMPSON/#why-use-simpson","title":"Why Use SIMPSON?","text":"<ul> <li> <p>Flexibility: Supports a broad range of NMR experiments (solid-state and liquid-state).</p> </li> <li> <p>Accuracy: Handles both simple and highly complex spin systems.</p> </li> <li> <p>Extendability: Uses Tcl scripting for defining simulations, making it customizable.</p> </li> <li> <p>Performance: Supports MPI (via mpirun) and optimized math libraries (BLAS/LAPACK/FFTW).</p> </li> </ul> <p>SIMPSON is particularly useful when:</p> <p>Designing new experiments before performing them on the spectrometer.</p> <p>Understanding the effects of anisotropic interactions (CSA, dipolar, quadrupolar).</p> <p>Benchmarking experimental data against theoretical predictions.</p> <p>In this page, you also will find how to install SIMPSON program in your linux environment.</p>"},{"location":"SIMPSON/SIMPSON/#how-to-run-simpson","title":"How to run simpson","text":"<p>Simpson can be invoked via terminal: <pre><code>simpson &lt;filename&gt;\n</code></pre> It is also possible to run it in parallel with the following command: <pre><code>mpirun -np &lt;n&gt; &lt;filename&gt;\n</code></pre></p>"},{"location":"SIMPSON/SIMPSON/#how-to-write-a-simpson-file","title":"How to write a simpson file","text":"<p>You can find how to write an input file for simpson using this link</p>"}]}